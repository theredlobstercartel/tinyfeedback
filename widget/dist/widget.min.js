/*! TinyFeedback Widget v1.0.0 | MIT */
!function(){"use strict";
/*!
     * TinyFeedback Widget v1.0.0
     * Lightweight feedback widget for websites
     */!function(){const t={position:"bottom-right",primaryColor:"#3b82f6",textColor:"#ffffff",apiUrl:"https://api.tinyfeedback.io/v1"},n='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>',o="üòä",i="üí°",e="üêõ",s='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',r="‚úÖ";class a{constructor(n){this.container=null,this.modal=null,this.selectedType=null,this.selectedRating=null,this.isSubmitting=!1,this.config=Object.assign(Object.assign({},t),n),this.validateConfig(),this.injectStyles(),this.render(),this.attachEventListeners()}validateConfig(){if(!this.config.apiKey)throw new Error("TinyFeedback: API key is required")}injectStyles(){if(document.getElementById("tfw-styles"))return;const t=document.createElement("style");t.id="tfw-styles",t.textContent='\n.tfw-widget{--tfw-primary:#3b82f6;--tfw-text:#fff;--tfw-bg:#fff;--tfw-shadow:0 4px 20px rgba(0,0,0,0.15);--tfw-radius:12px;position:fixed;z-index:99999;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}\n.tfw-btn{position:fixed;width:56px;height:56px;border-radius:50%;background:var(--tfw-primary);color:var(--tfw-text);border:none;cursor:pointer;box-shadow:var(--tfw-shadow);display:flex;align-items:center;justify-content:center;transition:transform .2s,box-shadow .2s;font-size:24px;padding:0}\n.tfw-btn:hover{transform:scale(1.05);box-shadow:0 6px 24px rgba(0,0,0,0.2)}\n.tfw-btn:active{transform:scale(.95)}\n.tfw-btn-br{bottom:20px;right:20px}\n.tfw-btn-bl{bottom:20px;left:20px}\n.tfw-btn-tr{top:20px;right:20px}\n.tfw-btn-tl{top:20px;left:20px}\n.tfw-modal{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;z-index:100000;padding:16px;backdrop-filter:blur(4px)}\n.tfw-modal.open{display:flex;animation:tfwFadeIn .2s ease}\n@keyframes tfwFadeIn{from{opacity:0}to{opacity:1}}\n.tfw-container{background:var(--tfw-bg);border-radius:var(--tfw-radius);width:100%;max-width:420px;max-height:90vh;overflow:auto;box-shadow:var(--tfw-shadow);animation:tfwSlideUp .3s ease}\n@keyframes tfwSlideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}\n.tfw-header{padding:20px 20px 0;display:flex;justify-content:space-between;align-items:center}\n.tfw-title{font-size:18px;font-weight:600;color:#111;margin:0}\n.tfw-close{width:32px;height:32px;border:none;background:transparent;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#666;transition:background .2s;font-size:20px}\n.tfw-close:hover{background:#f3f4f6;color:#111}\n.tfw-body{padding:20px}\n.tfw-options{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px}\n.tfw-option{padding:16px 12px;border:2px solid #e5e7eb;border-radius:var(--tfw-radius);cursor:pointer;text-align:center;transition:all .2s;background:#fff}\n.tfw-option:hover{border-color:var(--tfw-primary);background:#f8fafc}\n.tfw-option.selected{border-color:var(--tfw-primary);background:#eff6ff}\n.tfw-option-icon{font-size:28px;margin-bottom:8px;display:block}\n.tfw-option-label{font-size:13px;font-weight:500;color:#374151;display:block}\n.tfw-form{display:none}\n.tfw-form.open{display:block}\n.tfw-label{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:6px}\n.tfw-input,.tfw-textarea{width:100%;padding:12px;border:2px solid #e5e7eb;border-radius:8px;font-size:14px;font-family:inherit;box-sizing:border-box;transition:border-color .2s}\n.tfw-input:focus,.tfw-textarea:focus{outline:none;border-color:var(--tfw-primary)}\n.tfw-textarea{min-height:120px;resize:vertical}\n.tfw-field{margin-bottom:16px}\n.tfw-nps{display:flex;gap:8px;justify-content:center;margin-bottom:16px;flex-wrap:wrap}\n.tfw-nps-btn{width:40px;height:40px;border:2px solid #e5e7eb;border-radius:8px;background:#fff;cursor:pointer;font-size:14px;font-weight:600;color:#374151;transition:all .2s;padding:0}\n.tfw-nps-btn:hover{border-color:var(--tfw-primary)}\n.tfw-nps-btn.selected{background:var(--tfw-primary);color:var(--tfw-text);border-color:var(--tfw-primary)}\n.tfw-actions{display:flex;gap:12px;justify-content:flex-end;margin-top:20px}\n.tfw-btn-primary{padding:10px 20px;background:var(--tfw-primary);color:var(--tfw-text);border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:opacity .2s}\n.tfw-btn-primary:hover{opacity:.9}\n.tfw-btn-primary:disabled{opacity:.5;cursor:not-allowed}\n.tfw-btn-secondary{padding:10px 20px;background:transparent;color:#666;border:2px solid #e5e7eb;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}\n.tfw-btn-secondary:hover{border-color:#d1d5db;color:#111}\n.tfw-error{color:#dc2626;font-size:13px;margin-top:8px;padding:8px 12px;background:#fef2f2;border-radius:6px;display:none}\n.tfw-error.show{display:block}\n.tfw-success{text-align:center;padding:40px 20px}\n.tfw-success-icon{font-size:48px;margin-bottom:16px}\n.tfw-success-title{font-size:18px;font-weight:600;color:#111;margin:0 0 8px}\n.tfw-success-text{font-size:14px;color:#6b7280;margin:0}\n.tfw-back{margin-top:16px;padding:8px 16px;background:transparent;border:none;color:var(--tfw-primary);cursor:pointer;font-size:14px;font-weight:500}\n.tfw-back:hover{text-decoration:underline}\n@media (max-width:480px){.tfw-container{margin:0;max-height:100vh;border-radius:0}.tfw-modal{padding:0}.tfw-btn{width:48px;height:48px;font-size:20px}}\n'.replace(/var\(--tfw-primary\)/g,this.config.primaryColor).replace(/var\(--tfw-text\)/g,this.config.textColor),document.head.appendChild(t)}render(){this.container=document.createElement("div"),this.container.className="tfw-widget";const t=document.createElement("button");t.className=`tfw-btn tfw-btn-${this.getPositionClass()}`,t.innerHTML=n,t.setAttribute("aria-label","Open feedback"),t.onclick=()=>this.openModal(),this.container.appendChild(t),this.modal=document.createElement("div"),this.modal.className="tfw-modal",this.modal.innerHTML=this.getModalHTML(),this.container.appendChild(this.modal),document.body.appendChild(this.container)}getPositionClass(){return(this.config.position||"bottom-right").replace("-","")}getModalHTML(){return`\n        <div class="tfw-container">\n          <div class="tfw-header">\n            <h3 class="tfw-title">Send Feedback</h3>\n            <button class="tfw-close" aria-label="Close">${s}</button>\n          </div>\n          <div class="tfw-body">\n            <div class="tfw-step-1">\n              <div class="tfw-options">\n                <button class="tfw-option" data-type="nps">\n                  <span class="tfw-option-icon">${o}</span>\n                  <span class="tfw-option-label">Rate Us</span>\n                </button>\n                <button class="tfw-option" data-type="suggestion">\n                  <span class="tfw-option-icon">${i}</span>\n                  <span class="tfw-option-label">Suggestion</span>\n                </button>\n                <button class="tfw-option" data-type="bug">\n                  <span class="tfw-option-icon">${e}</span>\n                  <span class="tfw-option-label">Report Bug</span>\n                </button>\n              </div>\n            </div>\n            <div class="tfw-form" id="tfw-form">\n              <div class="tfw-field" id="tfw-nps-container" style="display:none">\n                <label class="tfw-label">How likely are you to recommend us?</label>\n                <div class="tfw-nps">\n                  ${[0,1,2,3,4,5,6,7,8,9,10].map(t=>`<button class="tfw-nps-btn" data-rating="${t}">${t}</button>`).join("")}\n                </div>\n              </div>\n              <div class="tfw-field">\n                <label class="tfw-label" for="tfw-message">Your feedback</label>\n                <textarea id="tfw-message" class="tfw-textarea" placeholder="Tell us what you think..." required></textarea>\n              </div>\n              <div class="tfw-field">\n                <label class="tfw-label" for="tfw-email">Email (optional)</label>\n                <input type="email" id="tfw-email" class="tfw-input" placeholder="your@email.com">\n              </div>\n              <div class="tfw-error" id="tfw-error"></div>\n              <div class="tfw-actions">\n                <button class="tfw-btn-secondary" id="tfw-back">Back</button>\n                <button class="tfw-btn-primary" id="tfw-submit">Send Feedback</button>\n              </div>\n            </div>\n            <div class="tfw-success" id="tfw-success" style="display:none">\n              <div class="tfw-success-icon">${r}</div>\n              <h4 class="tfw-success-title">Thank you!</h4>\n              <p class="tfw-success-text">Your feedback helps us improve.</p>\n              <button class="tfw-back" id="tfw-close-success">Close</button>\n            </div>\n          </div>\n        </div>\n      `}attachEventListeners(){if(!this.modal)return;this.modal.addEventListener("click",t=>{t.target===this.modal&&this.closeModal()});const t=this.modal.querySelector(".tfw-close");null==t||t.addEventListener("click",()=>this.closeModal()),this.modal.querySelectorAll(".tfw-option").forEach(t=>{t.addEventListener("click",()=>{const n=t.getAttribute("data-type");this.selectType(n)})}),this.modal.querySelectorAll(".tfw-nps-btn").forEach(t=>{t.addEventListener("click",()=>{const n=parseInt(t.getAttribute("data-rating")||"0");this.selectRating(n)})});const n=this.modal.querySelector("#tfw-back");null==n||n.addEventListener("click",()=>this.showOptions());const o=this.modal.querySelector("#tfw-submit");null==o||o.addEventListener("click",()=>this.submit());const i=this.modal.querySelector("#tfw-close-success");null==i||i.addEventListener("click",()=>this.closeModal());const e=this.modal.querySelector("#tfw-message");null==e||e.addEventListener("keydown",t=>{"Enter"===t.key&&(t.metaKey||t.ctrlKey)&&this.submit()})}openModal(){this.modal&&(this.modal.classList.add("open"),document.body.style.overflow="hidden",this.showOptions())}closeModal(){this.modal&&(this.modal.classList.remove("open"),document.body.style.overflow="",setTimeout(()=>this.resetForm(),300))}showOptions(){var t,n;const o=null===(t=this.modal)||void 0===t?void 0:t.querySelector(".tfw-step-1"),i=null===(n=this.modal)||void 0===n?void 0:n.querySelector("#tfw-form");null==o||o.setAttribute("style","display:block"),null==i||i.classList.remove("open"),this.selectedType=null,this.selectedRating=null}selectType(t){var n,o,i,e;this.selectedType=t;const s=null===(n=this.modal)||void 0===n?void 0:n.querySelector(".tfw-step-1"),r=null===(o=this.modal)||void 0===o?void 0:o.querySelector("#tfw-form"),a=null===(i=this.modal)||void 0===i?void 0:i.querySelector("#tfw-nps-container");null==s||s.setAttribute("style","display:none"),null==r||r.classList.add("open"),a&&a.setAttribute("style","nps"===t?"display:block":"display:none");const l=null===(e=this.modal)||void 0===e?void 0:e.querySelector(".tfw-title");l&&(l.textContent={nps:"Rate Your Experience",suggestion:"Share Your Suggestion",bug:"Report a Bug"}[t]),setTimeout(()=>{var t;const n=null===(t=this.modal)||void 0===t?void 0:t.querySelector("#tfw-message");null==n||n.focus()},100)}selectRating(t){var n;this.selectedRating=t;const o=null===(n=this.modal)||void 0===n?void 0:n.querySelectorAll(".tfw-nps-btn");null==o||o.forEach(n=>{n.classList.toggle("selected",parseInt(n.getAttribute("data-rating")||"0")===t)})}showError(t){var n;const o=null===(n=this.modal)||void 0===n?void 0:n.querySelector("#tfw-error");o&&(o.textContent=t,o.classList.add("show"))}hideError(){var t;const n=null===(t=this.modal)||void 0===t?void 0:t.querySelector("#tfw-error");null==n||n.classList.remove("show")}submit(){return __awaiter(this,void 0,void 0,function*(){var t,n,o;if(this.isSubmitting)return;const i=null===(t=this.modal)||void 0===t?void 0:t.querySelector("#tfw-message"),e=null===(n=this.modal)||void 0===n?void 0:n.querySelector("#tfw-email"),s=null==i?void 0:i.value.trim(),r=null==e?void 0:e.value.trim();if(this.hideError(),"nps"===this.selectedType&&null===this.selectedRating)return void this.showError("Please select a rating from 0 to 10");if(!s)return this.showError("Please enter your feedback"),void(null==i||i.focus());if(r&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return this.showError("Please enter a valid email address"),void(null==e||e.focus());this.isSubmitting=!0;const a=null===(o=this.modal)||void 0===o?void 0:o.querySelector("#tfw-submit");a&&(a.disabled=!0,a.textContent="Sending...");try{const t={type:this.selectedType,rating:this.selectedRating||void 0,message:s,email:r||void 0,url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()};yield this.sendFeedback(t),this.showSuccess()}catch(t){console.error("[TinyFeedback] Error:",t),this.showError(t instanceof Error?t.message:"Failed to send feedback. Please try again.")}finally{this.isSubmitting=!1,a&&(a.disabled=!1,a.textContent="Send Feedback")}})}sendFeedback(n){return __awaiter(this,void 0,void 0,function*(){const o=this.config.apiUrl||t.apiUrl,i=window.location.origin,e=yield fetch(`${o}/feedback`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this.config.apiKey,Origin:i},body:JSON.stringify(n)});if(!e.ok){if(403===e.status)throw new Error("Domain not authorized. Please check your API key configuration.");if(429===e.status)throw new Error("Too many requests. Please try again later.");const t=yield e.json().catch(()=>({error:"Unknown error"}));throw new Error(t.error||`Request failed (${e.status})`)}})}showSuccess(){var t,n;const o=null===(t=this.modal)||void 0===t?void 0:t.querySelector("#tfw-form"),i=null===(n=this.modal)||void 0===n?void 0:n.querySelector("#tfw-success");null==o||o.setAttribute("style","display:none"),null==i||i.setAttribute("style","display:block"),setTimeout(()=>{var t;(null===(t=this.modal)||void 0===t?void 0:t.classList.contains("open"))&&this.closeModal()},3e3)}resetForm(){var t,n,o,i,e,s,r;const a=null===(t=this.modal)||void 0===t?void 0:t.querySelector("#tfw-message"),l=null===(n=this.modal)||void 0===n?void 0:n.querySelector("#tfw-email"),d=null===(o=this.modal)||void 0===o?void 0:o.querySelector("#tfw-form"),f=null===(i=this.modal)||void 0===i?void 0:i.querySelector("#tfw-success");a&&(a.value=""),l&&(l.value=""),null==d||d.setAttribute("style",""),null==d||d.classList.remove("open"),null==f||f.setAttribute("style","display:none"),this.selectedType=null,this.selectedRating=null,this.hideError();const c=null===(e=this.modal)||void 0===e?void 0:e.querySelectorAll(".tfw-nps-btn");null==c||c.forEach(t=>t.classList.remove("selected"));const p=null===(s=this.modal)||void 0===s?void 0:s.querySelectorAll(".tfw-option");null==p||p.forEach(t=>t.classList.remove("selected"));const w=null===(r=this.modal)||void 0===r?void 0:r.querySelector(".tfw-title");w&&(w.textContent="Send Feedback")}destroy(){var t;const n=document.getElementById("tfw-styles");null==n||n.remove(),null===(t=this.container)||void 0===t||t.remove(),this.container=null,this.modal=null}}let l=null;function d(){const t=document.currentScript;if(!t)return;const n=t.getAttribute("data-api-key");if(!n)return void console.error("[TinyFeedback] API key required. Add data-api-key attribute to script tag.");const o={apiKey:n,position:t.getAttribute("data-position")||"bottom-right",primaryColor:t.getAttribute("data-color")||"#3b82f6",textColor:t.getAttribute("data-text-color")||"#ffffff",apiUrl:t.getAttribute("data-api-url")||void 0};l=new a(o)}window.TinyFeedback={init:t=>(null==l||l.destroy(),l=new a(t),l),destroy:()=>{null==l||l.destroy(),l=null},open:()=>null==l?void 0:l.openModal(),close:()=>null==l?void 0:l.closeModal()},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d()}()}();
