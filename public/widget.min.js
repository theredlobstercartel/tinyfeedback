/*! TinyFeedback Widget v1.0.0 | MIT */
!function(){"use strict";
/*!
   * TinyFeedback Widget v1.0.0
   * Lightweight feedback widget for websites
   */!function(){const t={position:"bottom-right",primaryColor:"#3b82f6",textColor:"#ffffff",apiUrl:"https://api.tinyfeedback.io/v1"};function n(n){this.config=Object.assign({},t,n),this.container=null,this.modal=null,this.selectedType=null,this.selectedRating=null,this.isSubmitting=!1,this.validateConfig(),this.injectStyles(),this.render(),this.attachEventListeners()}n.prototype.validateConfig=function(){if(!this.config.apiKey)throw Error("TinyFeedback: API key is required")},n.prototype.injectStyles=function(){if(!document.getElementById("tfw-styles")){var t=document.createElement("style");t.id="tfw-styles",t.textContent='\n.tfw-widget{--tfw-primary:#3b82f6;--tfw-text:#fff;--tfw-bg:#fff;--tfw-shadow:0 4px 20px rgba(0,0,0,0.15);--tfw-radius:12px;position:fixed;z-index:99999;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}\n.tfw-btn{position:fixed;width:56px;height:56px;border-radius:50%;background:var(--tfw-primary);color:var(--tfw-text);border:none;cursor:pointer;box-shadow:var(--tfw-shadow);display:flex;align-items:center;justify-content:center;transition:transform .2s,box-shadow .2s;font-size:24px;padding:0}\n.tfw-btn:hover{transform:scale(1.05);box-shadow:0 6px 24px rgba(0,0,0,0.2)}\n.tfw-btn:active{transform:scale(.95)}\n.tfw-btn-br{bottom:20px;right:20px}\n.tfw-btn-bl{bottom:20px;left:20px}\n.tfw-btn-tr{top:20px;right:20px}\n.tfw-btn-tl{top:20px;left:20px}\n.tfw-modal{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;z-index:100000;padding:16px;backdrop-filter:blur(4px)}\n.tfw-modal.open{display:flex;animation:tfwFadeIn .2s ease}\n@keyframes tfwFadeIn{from{opacity:0}to{opacity:1}}\n.tfw-container{background:var(--tfw-bg);border-radius:var(--tfw-radius);width:100%;max-width:420px;max-height:90vh;overflow:auto;box-shadow:var(--tfw-shadow);animation:tfwSlideUp .3s ease}\n@keyframes tfwSlideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}\n.tfw-header{padding:20px 20px 0;display:flex;justify-content:space-between;align-items:center}\n.tfw-title{font-size:18px;font-weight:600;color:#111;margin:0}\n.tfw-close{width:32px;height:32px;border:none;background:transparent;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#666;transition:background .2s;font-size:20px}\n.tfw-close:hover{background:#f3f4f6;color:#111}\n.tfw-body{padding:20px}\n.tfw-options{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px}\n.tfw-option{padding:16px 12px;border:2px solid #e5e7eb;border-radius:var(--tfw-radius);cursor:pointer;text-align:center;transition:all .2s;background:#fff}\n.tfw-option:hover{border-color:var(--tfw-primary);background:#f8fafc}\n.tfw-option.selected{border-color:var(--tfw-primary);background:#eff6ff}\n.tfw-option-icon{font-size:28px;margin-bottom:8px;display:block}\n.tfw-option-label{font-size:13px;font-weight:500;color:#374151;display:block}\n.tfw-form{display:none}\n.tfw-form.open{display:block}\n.tfw-label{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:6px}\n.tfw-input,.tfw-textarea{width:100%;padding:12px;border:2px solid #e5e7eb;border-radius:8px;font-size:14px;font-family:inherit;box-sizing:border-box;transition:border-color .2s}\n.tfw-input:focus,.tfw-textarea:focus{outline:none;border-color:var(--tfw-primary)}\n.tfw-textarea{min-height:120px;resize:vertical}\n.tfw-field{margin-bottom:16px}\n.tfw-nps{display:flex;gap:8px;justify-content:center;margin-bottom:16px;flex-wrap:wrap}\n.tfw-nps-btn{width:40px;height:40px;border:2px solid #e5e7eb;border-radius:8px;background:#fff;cursor:pointer;font-size:14px;font-weight:600;color:#374151;transition:all .2s;padding:0}\n.tfw-nps-btn:hover{border-color:var(--tfw-primary)}\n.tfw-nps-btn.selected{background:var(--tfw-primary);color:var(--tfw-text);border-color:var(--tfw-primary)}\n.tfw-actions{display:flex;gap:12px;justify-content:flex-end;margin-top:20px}\n.tfw-btn-primary{padding:10px 20px;background:var(--tfw-primary);color:var(--tfw-text);border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:opacity .2s}\n.tfw-btn-primary:hover{opacity:.9}\n.tfw-btn-primary:disabled{opacity:.5;cursor:not-allowed}\n.tfw-btn-secondary{padding:10px 20px;background:transparent;color:#666;border:2px solid #e5e7eb;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}\n.tfw-btn-secondary:hover{border-color:#d1d5db;color:#111}\n.tfw-error{color:#dc2626;font-size:13px;margin-top:8px;padding:8px 12px;background:#fef2f2;border-radius:6px;display:none}\n.tfw-error.show{display:block}\n.tfw-success{text-align:center;padding:40px 20px}\n.tfw-success-icon{font-size:48px;margin-bottom:16px}\n.tfw-success-title{font-size:18px;font-weight:600;color:#111;margin:0 0 8px}\n.tfw-success-text{font-size:14px;color:#6b7280;margin:0}\n.tfw-back{margin-top:16px;padding:8px 16px;background:transparent;border:none;color:var(--tfw-primary);cursor:pointer;font-size:14px;font-weight:500}\n.tfw-back:hover{text-decoration:underline}\n@media (max-width:480px){.tfw-container{margin:0;max-height:100vh;border-radius:0}.tfw-modal{padding:0}.tfw-btn{width:48px;height:48px;font-size:20px}}\n'.replace(/var\(--tfw-primary\)/g,this.config.primaryColor).replace(/var\(--tfw-text\)/g,this.config.textColor),document.head.appendChild(t)}},n.prototype.render=function(){this.container=document.createElement("div"),this.container.className="tfw-widget";var t=document.createElement("button");t.className="tfw-btn tfw-btn-"+this.getPositionClass(),t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>',t.setAttribute("aria-label","Open feedback"),t.onclick=this.openModal.bind(this),this.container.appendChild(t),this.modal=document.createElement("div"),this.modal.className="tfw-modal",this.modal.innerHTML=this.getModalHTML(),this.container.appendChild(this.modal),document.body.appendChild(this.container)},n.prototype.getPositionClass=function(){return(this.config.position||"bottom-right").replace("-","")},n.prototype.getModalHTML=function(){for(var t="",n=0;n<=10;n++)t+='<button class="tfw-nps-btn" data-rating="'+n+'">'+n+"</button>";return'<div class="tfw-container"><div class="tfw-header"><h3 class="tfw-title">Send Feedback</h3><button class="tfw-close" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button></div><div class="tfw-body"><div class="tfw-step-1"><div class="tfw-options"><button class="tfw-option" data-type="nps"><span class="tfw-option-icon">üòä</span><span class="tfw-option-label">Rate Us</span></button><button class="tfw-option" data-type="suggestion"><span class="tfw-option-icon">üí°</span><span class="tfw-option-label">Suggestion</span></button><button class="tfw-option" data-type="bug"><span class="tfw-option-icon">üêõ</span><span class="tfw-option-label">Report Bug</span></button></div></div><div class="tfw-form" id="tfw-form"><div class="tfw-field" id="tfw-nps-container" style="display:none"><label class="tfw-label">How likely are you to recommend us?</label><div class="tfw-nps">'+t+'</div></div><div class="tfw-field"><label class="tfw-label" for="tfw-message">Your feedback</label><textarea id="tfw-message" class="tfw-textarea" placeholder="Tell us what you think..." required></textarea></div><div class="tfw-field"><label class="tfw-label" for="tfw-email">Email (optional)</label><input type="email" id="tfw-email" class="tfw-input" placeholder="your@email.com"></div><div class="tfw-error" id="tfw-error"></div><div class="tfw-actions"><button class="tfw-btn-secondary" id="tfw-back">Back</button><button class="tfw-btn-primary" id="tfw-submit">Send Feedback</button></div></div><div class="tfw-success" id="tfw-success" style="display:none"><div class="tfw-success-icon">‚úÖ</div><h4 class="tfw-success-title">Thank you!</h4><p class="tfw-success-text">Your feedback helps us improve.</p><button class="tfw-back" id="tfw-close-success">Close</button></div></div></div>'},n.prototype.attachEventListeners=function(){var t=this;this.modal.addEventListener("click",function(n){n.target===t.modal&&t.closeModal()});var n=this.modal.querySelector(".tfw-close");n&&n.addEventListener("click",this.closeModal.bind(this)),this.modal.querySelectorAll(".tfw-option").forEach(function(n){n.addEventListener("click",function(){var i=n.getAttribute("data-type");t.selectType(i)})}),this.modal.querySelectorAll(".tfw-nps-btn").forEach(function(n){n.addEventListener("click",function(){var i=parseInt(n.getAttribute("data-rating")||"0");t.selectRating(i)})});var i=this.modal.querySelector("#tfw-back");i&&i.addEventListener("click",this.showOptions.bind(this));var o=this.modal.querySelector("#tfw-submit");o&&o.addEventListener("click",this.submit.bind(this));var e=this.modal.querySelector("#tfw-close-success");e&&e.addEventListener("click",this.closeModal.bind(this));var s=this.modal.querySelector("#tfw-message");s&&s.addEventListener("keydown",function(n){"Enter"===n.key&&(n.metaKey||n.ctrlKey)&&t.submit()})},n.prototype.openModal=function(){this.modal.classList.add("open"),document.body.style.overflow="hidden",this.showOptions()},n.prototype.closeModal=function(){this.modal.classList.remove("open"),document.body.style.overflow="",setTimeout(this.resetForm.bind(this),300)},n.prototype.showOptions=function(){var t=this.modal.querySelector(".tfw-step-1"),n=this.modal.querySelector("#tfw-form");t&&(t.style.display="block"),n&&n.classList.remove("open"),this.selectedType=null,this.selectedRating=null},n.prototype.selectType=function(t){this.selectedType=t;var n=this.modal.querySelector(".tfw-step-1"),i=this.modal.querySelector("#tfw-form"),o=this.modal.querySelector("#tfw-nps-container"),e=this.modal.querySelector(".tfw-title"),s=this.modal.querySelector("#tfw-message");n&&(n.style.display="none"),i&&i.classList.add("open"),o&&(o.style.display="nps"===t?"block":"none"),e&&(e.textContent={nps:"Rate Your Experience",suggestion:"Share Your Suggestion",bug:"Report a Bug"}[t]||"Send Feedback"),setTimeout(function(){s&&s.focus()},100)},n.prototype.selectRating=function(t){this.selectedRating=t,this.modal.querySelectorAll(".tfw-nps-btn").forEach(function(n){var i=parseInt(n.getAttribute("data-rating")||"0");n.classList.toggle("selected",i===t)})},n.prototype.showError=function(t){var n=this.modal.querySelector("#tfw-error");n&&(n.textContent=t,n.classList.add("show"))},n.prototype.hideError=function(){var t=this.modal.querySelector("#tfw-error");t&&t.classList.remove("show")},n.prototype.submit=function(){if(!this.isSubmitting){var t=this,n=this.modal.querySelector("#tfw-message"),i=this.modal.querySelector("#tfw-email"),o=n?n.value.trim():"",e=i?i.value.trim():"";if(this.hideError(),"nps"!==this.selectedType||null!==this.selectedRating){if(!o)return this.showError("Please enter your feedback"),void(n&&n.focus());if(e&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return this.showError("Please enter a valid email address"),void(i&&i.focus());this.isSubmitting=!0;var s=this.modal.querySelector("#tfw-submit");s&&(s.disabled=!0,s.textContent="Sending...");var r={type:this.selectedType,rating:this.selectedRating||void 0,message:o,email:e||void 0,url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()};this.sendFeedback(r).then(function(){t.showSuccess()}).catch(function(n){console.error("[TinyFeedback] Error:",n),t.showError(n.message||"Failed to send feedback. Please try again.")}).finally(function(){t.isSubmitting=!1,s&&(s.disabled=!1,s.textContent="Send Feedback")})}else this.showError("Please select a rating from 0 to 10")}},n.prototype.sendFeedback=function(n){var i=this.config.apiUrl||t.apiUrl,o=window.location.origin;return fetch(i+"/feedback",{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this.config.apiKey,Origin:o},body:JSON.stringify(n)}).then(function(t){if(!t.ok){if(403===t.status)throw Error("Domain not authorized. Please check your API key configuration.");if(429===t.status)throw Error("Too many requests. Please try again later.");return t.json().then(function(n){throw Error(n.error||"Request failed ("+t.status+")")}).catch(function(){throw Error("Request failed ("+t.status+")")})}})},n.prototype.showSuccess=function(){var t=this.modal.querySelector("#tfw-form"),n=this.modal.querySelector("#tfw-success");t&&(t.style.display="none"),n&&(n.style.display="block");var i=this;setTimeout(function(){i.modal.classList.contains("open")&&i.closeModal()},3e3)},n.prototype.resetForm=function(){var t=this.modal.querySelector("#tfw-message"),n=this.modal.querySelector("#tfw-email"),i=this.modal.querySelector("#tfw-form"),o=this.modal.querySelector("#tfw-success");t&&(t.value=""),n&&(n.value=""),i&&(i.style.display="",i.classList.remove("open")),o&&(o.style.display="none"),this.selectedType=null,this.selectedRating=null,this.hideError(),this.modal.querySelectorAll(".tfw-nps-btn").forEach(function(t){t.classList.remove("selected")}),this.modal.querySelectorAll(".tfw-option").forEach(function(t){t.classList.remove("selected")});var e=this.modal.querySelector(".tfw-title");e&&(e.textContent="Send Feedback")},n.prototype.destroy=function(){var t=document.getElementById("tfw-styles");t&&t.remove(),this.container&&this.container.remove(),this.container=null,this.modal=null};var i=null;function o(){var t=document.currentScript;if(t){var o=t.getAttribute("data-api-key");if(o){var e={apiKey:o,position:t.getAttribute("data-position")||"bottom-right",primaryColor:t.getAttribute("data-color")||"#3b82f6",textColor:t.getAttribute("data-text-color")||"#ffffff",apiUrl:t.getAttribute("data-api-url")||void 0};i=new n(e)}else console.error("[TinyFeedback] API key required. Add data-api-key attribute to script tag.")}}window.TinyFeedback={init:function(t){return i&&i.destroy(),i=new n(t)},destroy:function(){i&&i.destroy(),i=null},open:function(){i&&i.openModal()},close:function(){i&&i.closeModal()}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()}()}();
